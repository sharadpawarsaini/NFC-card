{% extends "base.html" %}
{% block content %}

<div class="max-w-6xl mx-auto mt-6">
    
    <!-- Header -->
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold">Admin Dashboard</h2>

        <a href="/admin/logout" 
           class="px-4 py-2 bg-red-600 text-white rounded">Logout</a>
    </div>

    <!-- Sections -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">

        <!-- Total Users -->
        <div class="p-6 bg-white rounded-xl shadow text-center">
            <h3 class="text-xl font-semibold">Total Users</h3>
            <p class="text-4xl font-bold mt-2 text-indigo-600">
                {{ total_users }}
            </p>
        </div>

        <!-- Total QR Scans -->
        <div class="p-6 bg-white rounded-xl shadow text-center">
            <h3 class="text-xl font-semibold">QR Scans</h3>
            <p class="text-4xl font-bold mt-2 text-green-600">
                {{ total_scans }}
            </p>
        </div>

        <!-- Total Emergency Alerts -->
        <div class="p-6 bg-white rounded-xl shadow text-center">
            <h3 class="text-xl font-semibold">Emergency Alerts</h3>
            <p class="text-4xl font-bold mt-2 text-red-600">
                {{ total_alerts }}
            </p>
        </div>

    </div>

    <!-- User Table -->
    <div class="mt-10 bg-white p-6 rounded-xl shadow">
        <h3 class="text-xl font-semibold mb-4">Registered Users</h3>

        <table class="w-full border-collapse">
            <thead>
                <tr class="bg-gray-100 text-left">
                    <th class="p-3 border">Name</th>
                    <th class="p-3 border">Email</th>
                    <th class="p-3 border">Blood Group</th>
                    <th class="p-3 border">Actions</th>
                </tr>
            </thead>

            <tbody>
                {% for u in users %}
                <tr class="hover:bg-gray-50">
                    <td class="p-3 border">{{ u.name }}</td>
                    <td class="p-3 border">{{ u.email }}</td>
                    <td class="p-3 border">{{ u.medical_data.get('blood_group', 'N/A') }}</td>
                    <td class="p-3 border">
                        <a href="/admin/user/{{ u._id }}" 
                           class="text-indigo-600 underline">View</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        {% if users|length == 0 %}
        <p class="text-center text-gray-500 mt-4">No users found.</p>
        {% endif %}
    </div>

</div>

{% endblock %}
